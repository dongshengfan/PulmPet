{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [
    "cc",
    "Class",
    "extends",
    "Component",
    "properties",
    "_model",
    "_maxBiasTouch",
    "_pointTouchForMenu",
    "v2",
    "_isMove",
    "_isOpenMenu",
    "onLoad",
    "node",
    "on",
    "Node",
    "EventType",
    "TOUCH_MOVE",
    "_onTouchMoveAnimal",
    "bind",
    "TOUCH_START",
    "_onTouchStartAnimal",
    "TOUCH_END",
    "_onTouchEndAnimal",
    "settings",
    "model",
    "event",
    "myEvent",
    "Event",
    "EventCustom",
    "detail",
    "startMotion",
    "x",
    "y",
    "controller",
    "dispatchEvent",
    "getLocation",
    "stopPropagation",
    "delta",
    "touch",
    "getDelta",
    "_isCheckOnOpenMenu",
    "deltaMotion",
    "pointEnd",
    "_refocusMenu",
    "point",
    "X",
    "Math",
    "abs",
    "Y",
    "_publishOpenMenuAnimal",
    "_publishCloseMenuAnimal",
    "openMenu",
    "closeMenu",
    "moveToPoint",
    "runVoice",
    "runSit",
    "runFrighten",
    "runAreal",
    "runCare",
    "runLie",
    "runAttention",
    "getCharacteristics"
  ],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "/**\r\n *\r\n */\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        _model: null,//модель животного\r\n\r\n        _maxBiasTouch: 15,//максимальное смещение тача для открытия меню (px)\r\n        _pointTouchForMenu: cc.v2,//точка старта тача по животному\r\n\r\n        _isMove: false,//флаг для определения движется ли живоное за пользователем\r\n        _isOpenMenu: false,//флаг для определения открыто ли меню\r\n    },\r\n\r\n    onLoad(){\r\n        this._isOpenMenu = false;\r\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoveAnimal.bind(this));\r\n        this.node.on(cc.Node.EventType.TOUCH_START, this._onTouchStartAnimal.bind(this));\r\n        this.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEndAnimal.bind(this));\r\n    },\r\n\r\n\r\n    /**\r\n     * Настраивает доступные действия плюшки для животного и характеристики\r\n     */\r\n    settings(model){\r\n        this._model = model;\r\n    },\r\n\r\n\r\n    /**\r\n     * Обработчик события начала тача\r\n     * @param event\r\n     * @private\r\n     */\r\n    _onTouchStartAnimal(event){\r\n        let myEvent = new cc.Event.EventCustom('startMotionAnimal', true);\r\n        myEvent.detail = {\r\n            startMotion: cc.v2(this.node.x, this.node.y),\r\n            controller: this,\r\n        };\r\n        this.node.dispatchEvent(myEvent);//разослали евент\r\n        this._isMove = false;//животное не движется за пользователем\r\n        this._pointTouchForMenu = event.getLocation();//считали точку первого нажатия\r\n        event.stopPropagation();\r\n    },\r\n\r\n    /**\r\n     * Обработчик события движения тача.\r\n     * @param event\r\n     * @private\r\n     */\r\n    _onTouchMoveAnimal(event){\r\n        //   cc.log(event);\r\n        var delta = event.touch.getDelta();\r\n        if (this._isCheckOnOpenMenu(event.getLocation()) && !this._isOpenMenu) {\r\n            this._isMove = true;\r\n            let myEvent = new cc.Event.EventCustom('motionAnimal', true);\r\n            myEvent.detail = {\r\n                deltaMotion: delta,\r\n            };\r\n            this.node.dispatchEvent(myEvent);\r\n        }\r\n        event.stopPropagation();\r\n    },\r\n\r\n    /**\r\n     * Обработчик события завершения тача\r\n     * @param event\r\n     * @private\r\n     */\r\n    _onTouchEndAnimal(event){\r\n        // cc.log(event);\r\n        if (this._isMove) {\r\n            let myEvent = new cc.Event.EventCustom('endMotionAnimal', true);\r\n            myEvent.detail = {\r\n                pointEnd: event.getLocation(),\r\n            };\r\n            this.node.dispatchEvent(myEvent);\r\n            this._isMove = false;\r\n        } else {\r\n            this._refocusMenu();\r\n        }\r\n        event.stopPropagation();\r\n    },\r\n\r\n    /**\r\n     * Проверяет открывается меню или нет. Путем сканирования точки тача на выходза пределы от начапльной точки\r\n     * @param point\r\n     * @return {boolean}\r\n     * @private\r\n     */\r\n    _isCheckOnOpenMenu(point){\r\n        let X = Math.abs(this._pointTouchForMenu.x - point.x) > this._maxBiasTouch;\r\n        let Y = Math.abs(this._pointTouchForMenu.y - point.y) > this._maxBiasTouch;\r\n        return X || Y;\r\n    },\r\n\r\n    /**\r\n     * Изменяет состояние меню\r\n     * @private\r\n     */\r\n    _refocusMenu(){\r\n        this._isOpenMenu = !this._isOpenMenu;\r\n        (this._isOpenMenu) ? this._publishOpenMenuAnimal() : this._publishCloseMenuAnimal();\r\n\r\n    },\r\n\r\n    /**\r\n     * Открытие меню животного\r\n     */\r\n    _publishOpenMenuAnimal(){\r\n        let myEvent = new cc.Event.EventCustom('openMenuAnimal', true);\r\n        myEvent.detail = {\r\n            controller: this,\r\n        };\r\n        this.node.dispatchEvent(myEvent);\r\n    },\r\n\r\n    /**\r\n     * Закрыто меню с животными\r\n     */\r\n    _publishCloseMenuAnimal(){\r\n        let myEvent = new cc.Event.EventCustom('closeMenuAnimal', true);\r\n        myEvent.detail = {\r\n            controller: this,\r\n        };\r\n        this.node.dispatchEvent(myEvent);\r\n    },\r\n\r\n    /**\r\n     * Открытие меню\r\n     */\r\n    openMenu(){\r\n        this._isOpenMenu = true;\r\n        this._publishOpenMenuAnimal();\r\n    },\r\n\r\n    /**\r\n     * Закрыть меню\r\n     */\r\n    closeMenu(){\r\n        this._isOpenMenu = false;\r\n        this._publishCloseMenuAnimal();\r\n    },\r\n\r\n    /**\r\n     * Сообщает модели до какой точки надо дойти\r\n     * @param point\r\n     */\r\n    moveToPoint(point){\r\n        this._model.moveToPoint(point);\r\n    },\r\n\r\n    /**\r\n     * Подать звук\r\n     */\r\n    runVoice(){\r\n\r\n    },\r\n\r\n    /**\r\n     * Сесть\r\n     */\r\n    runSit(){\r\n\r\n    },\r\n\r\n    /**\r\n     * Испугаться\r\n     */\r\n    runFrighten(){\r\n\r\n    },\r\n\r\n    /**\r\n     * Показать ареалы\r\n     */\r\n    runAreal(){\r\n\r\n    },\r\n\r\n    /**\r\n     * Поласкаться\r\n     */\r\n    runCare(){\r\n\r\n    },\r\n\r\n    /**\r\n     * Лечь\r\n     */\r\n    runLie(){\r\n\r\n    },\r\n\r\n    /**\r\n     * Приготовиться\r\n     */\r\n    runAttention(){\r\n\r\n    },\r\n\r\n    /**\r\n     * Возвращает массив характеристик у животного\r\n     * @return {*|any}\r\n     */\r\n    getCharacteristics(){\r\n        return this._model.getCharacteristics();\r\n    }\r\n\r\n});"
  ]
}